CREATE DATABASE LAB03;

USE LAB03;

--1
CREATE TABLE TB_DVD(
	CODIGO		INT			identity(1,1) 	PRIMARY KEY,
	TITULO		VARCHAR(20)	NOT NULL,
	LANCAMENTO	DATETIME	NOT NULL,
	CATEGORIA	VARCHAR(40) NOT NULL
);

DROP TABLE TB_CLIENTE;

--2
CREATE TABLE TB_CLIENTE(
	MATRICULA	INT			NOT NULL	PRIMARY KEY,
	NOME		VARCHAR(40)	NOT NULL,
	CPF			VARCHAR(20)	NOT NULL,
	TELEFONE	VARCHAR(15),
	CADASTRO	DATETIME	NOT NULL
);

--3

--A
INSERT INTO TB_DVD
VALUES
	('PREMONIÇÃO','19970506','SUSPENSE'),
	('CARROS','20050312','ANIMAÇÃO'),
	('ROCKY, UM LUTADOR','19760101','DRAMA');

--B
INSERT INTO TB_CLIENTE
VALUES
	(2025,'KLEBER','12345678900','8888-8888','20050312'),
	(2012,'KLEISON','11111111111','8888-8888','20050312'),
	(2023,'KLEITON','12121212121',NULL,'20050312'); --C

--4

--A
SELECT * FROM TB_DVD

--B
SELECT TITULO FROM TB_DVD
WHERE LANCAMENTO >= '19970101' AND LANCAMENTO <= '19971231';

--C
SELECT TITULO FROM TB_DVD
WHERE LANCAMENTO >= '20050101' AND LANCAMENTO <= '20051231' AND CATEGORIA = 'ANIMAÇÃO';

--D
SELECT CODIGO,TITULO FROM TB_DVD;

--5

--A
SELECT * FROM TB_CLIENTE
ORDER BY NOME;

--B
SELECT * FROM TB_DVD
ORDER BY LANCAMENTO ASC;

--C
SELECT * FROM TB_CLIENTE
WHERE TELEFONE  IS NOT NULL;

--D
SELECT * FROM TB_DVD
WHERE TITULO LIKE '%ROCKY%';

--6

--A
UPDATE TB_CLIENTE 
SET TELEFONE = '2025-6969'
WHERE MATRICULA = 2025;

--B
UPDATE TB_DVD
SET CATEGORIA  = 'AÇÃO'
WHERE CATEGORIA = 'DRAMA';

--C
DELETE TB_DVD
WHERE CATEGORIA = 'ANIMAÇÃO';

--D
DELETE TB_CLIENTE
WHERE TELEFONE IS NULL; 
















































